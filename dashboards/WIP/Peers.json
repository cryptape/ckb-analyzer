{"annotations":{"list":[{"builtIn":1,"datasource":"-- Grafana --","enable":true,"hide":true,"iconColor":"rgba(0, 211, 255, 1)","name":"Annotations \u0026 Alerts","type":"dashboard"}]},"editable":true,"gnetId":null,"graphTooltip":0,"id":null,"iteration":1604415451777,"links":[],"panels":[{"datasource":null,"fieldConfig":{"defaults":{"custom":{"align":null,"filterable":false},"mappings":[],"thresholds":{"mode":"absolute","steps":[{"color":"green","value":null},{"color":"red","value":80}]}},"overrides":[]},"gridPos":{"h":3,"w":24,"x":0,"y":0},"id":4,"options":{"showHeader":true},"pluginVersion":"7.3.1","targets":[{"expr":"ckb_shared_best_header_number{job=\"$job\",env=\"$env\",instance=~\"$instance\"}","format":"table","instant":true,"interval":"","legendFormat":"","refId":"A"}],"timeFrom":null,"timeShift":null,"title":"Local","transformations":[{"id":"seriesToColumns","options":{"byField":"instance"}},{"id":"organize","options":{"excludeByName":{"Time":false,"__name__":true,"env":true,"instance":true,"job":true},"indexByName":{},"renameByName":{"Value":"shared_best_known_number"}}}],"type":"table"},{"datasource":null,"fieldConfig":{"defaults":{"custom":{"align":null,"displayMode":"auto","filterable":true},"mappings":[],"thresholds":{"mode":"absolute","steps":[{"color":"green","value":null},{"color":"red","value":80}]},"unit":"none"},"overrides":[{"matcher":{"id":"byType","options":"boolean"},"properties":[{"id":"custom.width"},{"id":"mappings","value":[{"from":"","id":1,"text":"yes","to":"","type":1,"value":"true"},{"from":"","id":2,"text":"no","to":"","type":1,"value":"false"}]}]}]},"gridPos":{"h":10,"w":24,"x":0,"y":3},"id":2,"options":{"frameIndex":1,"showHeader":true,"sortBy":[{"desc":true,"displayName":"best_known"}]},"pluginVersion":"7.3.1","targets":[{"expr":"ckb_peer_attr","format":"table","hide":false,"instant":true,"interval":"","legendFormat":"222","refId":"A"},{"expr":"ckb_peer_last_common_header_number","format":"table","hide":false,"instant":true,"interval":"","legendFormat":"","refId":"B"},{"expr":"ckb_peer_best_known_header_number","format":"table","instant":true,"interval":"","legendFormat":"","refId":"C"},{"expr":"ckb_peer_tasks_limit","format":"table","instant":true,"interval":"","legendFormat":"","refId":"D"},{"expr":"ckb_peer_n_tx_ask_for","format":"table","instant":true,"interval":"","legendFormat":"","refId":"E"}],"timeFrom":null,"timeShift":null,"title":"Peers (Total $total_peers)","transformations":[{"id":"seriesToColumns","options":{"byField":"host"}},{"id":"organize","options":{"excludeByName":{"Time":true,"Value #A":true,"__name__":true,"env":true,"instance":true,"job":true},"indexByName":{"Time":1,"Value #A":6,"Value #B":7,"Value #C":8,"Value #D":9,"Value #E":10,"__name__":2,"env":3,"host":0,"instance":4,"is_disconnected":11,"is_outbound":12,"is_protected":13,"is_sync_started":14,"is_whitelist":15,"job":5},"renameByName":{"Value #A":"","Value #B":"last_common","Value #C":"best_known","Value #D":"tasks_limit","Value #E":"n_tx_ask_for"}}}],"type":"table"},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":null,"decimals":0,"fieldConfig":{"defaults":{"custom":{}},"overrides":[]},"fill":1,"fillGradient":0,"gridPos":{"h":7,"w":24,"x":0,"y":13},"hiddenSeries":false,"id":6,"legend":{"alignAsTable":true,"avg":false,"current":true,"max":false,"min":false,"show":true,"sort":"current","sortDesc":true,"total":false,"values":true},"lines":true,"linewidth":1,"nullPointMode":"null","options":{"alertThreshold":true},"percentage":false,"pluginVersion":"7.3.1","pointradius":2,"points":false,"renderer":"flot","seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"rate(ckb_peer_accumulated_tasks_total{job=\"$job\",env=\"$env\",instance=~\"$instance\"}[$interval])","interval":"","legendFormat":"peer-{{host}}","refId":"A"}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Peers Assigned Tasks in Recent $interval","tooltip":{"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"$$hashKey":"object:350","format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true},{"$$hashKey":"object:351","format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}}],"refresh":false,"schemaVersion":26,"style":"dark","tags":[],"templating":{"list":[{"current":{"selected":false,"text":"ckb","value":"ckb"},"error":null,"hide":2,"label":"Job","name":"job","options":[{"selected":true,"text":"ckb","value":"ckb"}],"query":"ckb","skipUrlSync":false,"type":"constant"},{"allValue":null,"current":{"selected":false,"text":"stage","value":"stage"},"datasource":"prometheus","definition":"label_values({job=\"$job\"}, env)","error":null,"hide":0,"includeAll":false,"label":"Env","multi":false,"name":"env","options":[],"query":"label_values({job=\"$job\"}, env)","refresh":2,"regex":"","skipUrlSync":false,"sort":1,"tagValuesQuery":"","tags":[],"tagsQuery":"","type":"query","useTags":false},{"allValue":null,"current":{"selected":false,"text":"13.212.112.4:8100","value":"13.212.112.4:8100"},"datasource":"prometheus","definition":"label_values({job=\"$job\",env=\"$env\"}, instance)","error":null,"hide":0,"includeAll":false,"label":"Instance","multi":false,"name":"instance","options":[],"query":"label_values({job=\"$job\",env=\"$env\"}, instance)","refresh":2,"regex":"","skipUrlSync":false,"sort":1,"tagValuesQuery":"","tags":[],"tagsQuery":"","type":"query","useTags":false},{"auto":false,"auto_count":30,"auto_min":"10s","current":{"selected":false,"text":"10s","value":"10s"},"error":null,"hide":0,"label":"Interval","name":"interval","options":[{"selected":true,"text":"10s","value":"10s"},{"selected":false,"text":"30s","value":"30s"},{"selected":false,"text":"1m","value":"1m"},{"selected":false,"text":"5m","value":"5m"},{"selected":false,"text":"10m","value":"10m"},{"selected":false,"text":"30m","value":"30m"}],"query":"10s,30s,1m,5m,10m,30m","refresh":2,"skipUrlSync":false,"type":"interval"},{"allValue":null,"current":{"isNone":true,"selected":false,"text":"None","value":""},"datasource":"prometheus","definition":"query_result(ckb_peers_total{job=\"$job\", env=\"$env\", instance=~\"$instance\"})","error":null,"hide":2,"includeAll":false,"label":"TotalPeers","multi":false,"name":"total_peers","options":[],"query":"query_result(ckb_peers_total{job=\"$job\", env=\"$env\", instance=~\"$instance\"})","refresh":2,"regex":"/.* (.*) .*/","skipUrlSync":false,"sort":0,"tagValuesQuery":"","tags":[],"tagsQuery":"","type":"query","useTags":false}]},"time":{"from":"now-5m","to":"now"},"timepicker":{},"timezone":"","title":"Peers","uid":"GzF-N42Gk","version":2}
